<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Godot Game Assembler</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<header>Godot Game Assembler</header>

<div id="app-root">

  <!-- TOP HALF -->
  <div id="top-area">

    <!-- TOP LEFT: PROJECT / FILES -->
    <div id="top-left" class="panel">
      <div class="panel-title">Project / Files</div>
      <div id="project-tree">
        <em>No scenes</em>
      </div>
    </div>

    <!-- TOP RIGHT: FILE INFO / PREVIEW -->
    <div id="top-right" class="panel">
      <div class="panel-title">File Information</div>
      <div id="file-info">
        <em>No file selected</em>
      </div>
      <div id="file-preview">
        <em>Preview will appear here</em>
      </div>
    </div>

  </div>

  <!-- BOTTOM HALF: NLP -->
  <div id="bottom-area" class="panel">
    <div class="nlp-input-row">
      <input id="nlp-command" placeholder="Type a command..." />
      <button id="nlp-send">Send</button>
    </div>

    <div id="nlp-log"></div>

    <!-- Dynamic suggestion buttons -->
    <div id="suggestions"></div>
  </div>

</div>

<!-- ============================= -->
<!-- Android Touch Layout Editor -->
<!-- ============================= -->
<div id="touch-editor"
     style="display:none;
            position:fixed;
            top:0;
            left:0;
            width:100%;
            height:100%;
            background:rgba(0,0,0,0.85);
            z-index:9999;
            flex-direction:column;">

  <!-- Top Bar -->
  <div style="flex:0 0 50px;
              background:#222;
              display:flex;
              align-items:center;
              padding:5px;
              border-bottom:2px solid #444;">

    <span style="flex:1;
                 color:#eee;
                 font-weight:bold;
                 font-size:1.2em;">
      Android Touch Layout Editor
    </span>

    <button id="save-editor"
            style="margin-right:5px;
                   padding:5px 10px;
                   background:#333;
                   color:#eee;
                   border:1px solid #444;
                   cursor:pointer;">
      Save
    </button>

    <button id="close-editor"
            style="padding:5px 10px;
                   background:#333;
                   color:#eee;
                   border:1px solid #444;
                   cursor:pointer;">
      Close
    </button>
  </div>

  <!-- Canvas Area -->
  <div id="editor-canvas"
       style="flex:1;
              position:relative;
              background:#111;
              overflow:hidden;">
    <!-- Touch buttons are injected dynamically -->
  </div>

</div>

<!-- ============================= -->
<!-- CORE SYSTEMS -->
<!-- ============================= -->
<script src="core/project_graph.js"></script>
<script src="libs/project_manager_core.js"></script>
<script src="asset_manager/asset_handler.js"></script>
<script src="libs/scene_composer.js"></script>
<script src="export/zip_exporter.js"></script>

<!-- ============================= -->
<!-- NLP + GODOT ASSEMBLER LOGIC -->
<!-- ============================= -->
<script src="libs/jszip.min.js"></script>

<!-- Modular Godot Assembler -->
<script src="libs/godot_state.js"></script>
<script src="libs/godot_ui.js"></script>
<script src="libs/godot_file_tree.js"></script>
<script src="libs/godot_nodes.js"></script>
<script src="libs/godot_touch_editor.js"></script>
<script src="libs/godot_input.js"></script>

<!-- NLP (used by godot_input / flow) -->
<script src="libs/nlp_pro.js"></script>

<!-- ============================= -->
<!-- GUI â†’ INPUT BRIDGE -->
<!-- ============================= -->
<script>
  const nlpInput = document.getElementById("nlp-command");
  const nlpSend  = document.getElementById("nlp-send");

  async function sendNLPCommandGUI() {
    const cmd = nlpInput.value.trim();
    if (!cmd) return;
    nlpInput.value = "";

    if (window.GodotInput && GodotInput.handleUserInput) {
      await GodotInput.handleUserInput(cmd);
    } else {
      console.error("GodotInput not initialized.");
    }
  }

  nlpSend.addEventListener("click", sendNLPCommandGUI);
  nlpInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter") sendNLPCommandGUI();
  });
</script>

</body>
</html>
