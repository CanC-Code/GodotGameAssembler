<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GodotGameAssembler</title>
<style>
  body { margin:0; font-family:sans-serif; background:#1e1e1e; color:#f0f0f0; }
  header { background:#282c34; padding:1em; text-align:center; font-size:1.5em; }
  #top { display:flex; height:50vh; gap:1em; padding:1em; }
  #file-browser, #asset-preview { flex:1; background:#2b2b2b; padding:1em; border-radius:8px; overflow:auto; }
  #bottom { height:50vh; background:#2b2b2b; padding:1em; border-radius:8px; display:flex; flex-direction:column; }
  .panel { margin-bottom:1em; }
  button,input,select,textarea { border:none; border-radius:4px; padding:0.5em; margin-top:0.5em; width:100%; }
  #nlp-log { flex:1; overflow-y:auto; background:#1b1b1b; padding:0.5em; border-radius:4px; }
  #nlp-input { display:flex; gap:0.5em; margin-top:0.5em; }
  #nlp-input input { flex:1; }
  h3 { margin-top:0; }
</style>
</head>
<body>
<header>GodotGameAssembler</header>

<div id="top">
  <div id="file-browser">
    <h3>Scenes & Nodes</h3>
    <div id="scene-list"></div>
    <button onclick="collapseScenes()">Collapse/Expand</button>
    <hr>
    <h3>Scripts</h3>
    <div id="script-list"></div>
  </div>

  <div id="asset-preview">
    <h3>Asset Preview</h3>
    <div id="asset-info"></div>
    <div id="asset-display"></div>
    <button onclick="collapseAssets()">Collapse/Expand</button>
  </div>
</div>

<div id="bottom">
  <h3>NLP Interface</h3>
  <div id="nlp-log"></div>
  <div id="nlp-input">
    <input type="text" id="nlp-command" placeholder="Type command here">
    <button onclick="sendNLPCommandGUI()">Send</button>
  </div>
</div>

<script src="libs/jszip.min.js"></script>
<script src="libs/FileSaver.min.js"></script>
<script src="libs/three.min.js"></script>
<script src="libs/nlp_pro.js"></script>
<script src="godot.js"></script>
<script src="project_manager.gd"></script>
<script>
  // Placeholder for collapsible behavior
  function collapseScenes(){ /* toggle scene list */ }
  function collapseAssets(){ /* toggle asset preview */ }

  // Placeholder for file selection
  function selectAsset(assetName){
    const asset = ProjectManager.list_assets()[assetName];
    const display = document.getElementById("asset-display");
    display.innerHTML = "";
    if(!asset) return;

    if(asset.type==="texture"){
      const img = document.createElement("img");
      img.src = URL.createObjectURL(new Blob([asset.data]));
      img.style.maxWidth="100%";
      display.appendChild(img);
    } else if(asset.type==="gltf"){
      const container = document.createElement("div");
      container.style.width="100%";
      container.style.height="300px";
      display.appendChild(container);

      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(75, container.offsetWidth/container.offsetHeight,0.1,1000);
      const renderer = new THREE.WebGLRenderer({antialias:true});
      renderer.setSize(container.offsetWidth,container.offsetHeight);
      container.appendChild(renderer.domElement);

      const loader = new THREE.GLTFLoader();
      const blob = new Blob([asset.data]);
      loader.parse(blob, "", function(gltf){
        scene.add(gltf.scene);
        camera.position.z = 5;
        function animate(){
          requestAnimationFrame(animate);
          renderer.render(scene,camera);
        }
        animate();
      });
    }
    // TODO: audio preview, font preview
  }

</script>
</body>
</html>